<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaction Test Page</title>
    <style>
        #deviceList {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
        }

        .device-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .device-item:last-child {
            border-bottom: none;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .test-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* 按钮测试样式 */
        #testButton {
            padding: 12px 24px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #testButton:hover {
            background-color: #2980b9;
        }

        #buttonResult {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 20px;
        }

        /* 滚动区域样式 */
        #scrollArea {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            background-color: #fafafa;
        }

        .scroll-content {
            height: 800px;
            background: linear-gradient(to bottom, #e1f5fe, #b3e5fc);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
        }

        #scrollResult {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 20px;
        }

        /* 拖拽元素样式 */
        #dragContainer {
            position: relative;
            height: 300px;
            border: 1px dashed #ccc;
            background-color: #fafafa;
            border-radius: 4px;
        }

        #draggableElement {
            width: 100px;
            height: 100px;
            background-color: #e74c3c;
            border-radius: 8px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: move;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* 吸附区域样式 */
        .snap-area {
            position: absolute;
            width: 80px;
            height: 80px;
            border: 2px dashed #3498db;
            border-radius: 6px;
            background-color: rgba(52, 152, 219, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3498db;
            font-size: 12px;
            pointer-events: none;
            /* 确保不会干扰拖拽 */
        }

        #snapArea1 {
            top: 20px;
            left: 20px;
        }

        #snapArea2 {
            top: 20px;
            right: 20px;
        }

        #snapArea3 {
            bottom: 20px;
            left: 20px;
        }

        #snapArea4 {
            bottom: 20px;
            right: 20px;
        }

        #dragResult {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 20px;
        }

        /* 悬停测试样式 */
        #hoverContainer {
            text-align: center;
            padding: 20px;
        }

        #deleteButton {
            padding: 12px 24px;
            background-color: #f8f9fa;
            color: #d73a49;
            border: 1px solid rgba(27, 31, 35, 0.15);
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #deleteButton:hover {
            background-color: #d73a49;
            color: white;
            border-color: #d73a49;
        }

        #hoverResult {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 20px;
        }

        /* 文字选择测试样式 */
        #selectableText {
            padding: 15px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            line-height: 1.6;
            text-align: justify;
        }

        #selectionResult {
            margin-top: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            min-height: 20px;
        }
    </style>
</head>

<body>
    <h1>Interaction Test Page</h1>

    <!-- Button Test Area -->
    <div class="test-section">
        <h2>1. Button Test</h2>
        <p>Click the button below to test click events:</p>
        <button id="testButton" data-hm-type="button">Click Me</button>
        <div id="buttonResult">Results will be displayed here...</div>
    </div>

    <!-- Scroll Area Test -->
    <div class="test-section">
        <h2>2. Scroll Area Test</h2>
        <p>Scroll with your mouse wheel in the area below:</p>
        <div id="scrollArea" data-hm-type="scroll">
            <div class="scroll-content">
                <div>Scroll Area Top</div>
                <div>Scroll Area Middle</div>
                <div>Scroll Area Bottom</div>
            </div>
        </div>
        <div id="scrollResult">Scroll results will be displayed here...</div>
    </div>

    <!-- Drag Element Test -->
    <div class="test-section">
        <h2>3. Drag Element Test</h2>
        <p>Drag the red square below (it will snap to blue areas when close):</p>
        <div id="dragContainer">
            <div id="draggableElement" data-hm-type="drag">Drag Me</div>
            <!-- Snap Areas -->
            <div id="snapArea1" class="snap-area" data-hm-type="snapArea">Snap Area 1</div>
            <div id="snapArea2" class="snap-area" data-hm-type="snapArea">Snap Area 2</div>
            <div id="snapArea3" class="snap-area" data-hm-type="snapArea">Snap Area 3</div>
            <div id="snapArea4" class="snap-area" data-hm-type="snapArea">Snap Area 4</div>
        </div>
        <div id="dragResult">Drag results will be displayed here...</div>
    </div>

    <!-- Hover Test Area -->
    <div class="test-section">
        <h2>4. Hover Test</h2>
        <p>Hover over the button below (similar to GitHub's delete repository button):</p>
        <div id="hoverContainer">
            <button id="deleteButton" data-hm-type="warningButton">Delete this repository</button>
        </div>
        <div id="hoverResult">Hover results will be displayed here...</div>
    </div>

    <!-- Text Selection Test Area -->
    <div class="test-section">
        <h2>5. Text Selection Test</h2>
        <p>Select some text in the area below:</p>
        <div id="selectableText" data-hm-type="selectableText">
            This is a selectable text. You can use your mouse to select any text in this area. After selection, the
            selected content will be displayed in real-time in the result area below. This test is used to verify if the
            text selection function works properly. You can try selecting single words, entire lines, or content across
            multiple lines.
        </div>
        <div id="selectionResult">Selection results will be displayed here...</div>
    </div>
    <script>
        // Button test functionality
        const testButton = document.getElementById('testButton');
        const buttonResult = document.getElementById('buttonResult');
        let clickCount = 0;

        testButton.addEventListener('click', () => {
            clickCount++;
            buttonResult.textContent = `Button clicked ${clickCount} times`;

            // Change button color for visual feedback
            testButton.style.backgroundColor = getRandomColor();
            setTimeout(() => {
                testButton.style.backgroundColor = '#3498db';
            }, 300);
        });

        // Scroll area test functionality
        const scrollArea = document.getElementById('scrollArea');
        const scrollResult = document.getElementById('scrollResult');

        scrollArea.addEventListener('scroll', () => {
            const scrollTop = scrollArea.scrollTop;
            const scrollHeight = scrollArea.scrollHeight;
            const clientHeight = scrollArea.clientHeight;
            const scrollPercentage = Math.round((scrollTop / (scrollHeight - clientHeight)) * 100);

            scrollResult.textContent = `Scroll position: ${scrollTop}px, Scroll percentage: ${scrollPercentage}%`;
        });

        // Drag element test functionality
        const draggableElement = document.getElementById('draggableElement');
        const dragContainer = document.getElementById('dragContainer');
        const dragResult = document.getElementById('dragResult');

        // Get all snap areas
        const snapAreas = document.querySelectorAll('.snap-area');

        let isDragging = false;
        let offsetX, offsetY;
        let isSnapped = false;
        let currentSnapArea = null;

        // Snap threshold (pixels)
        const snapThreshold = 20;

        draggableElement.addEventListener('mousedown', (e) => {
            isDragging = true;
            isSnapped = false;
            currentSnapArea = null;

            // Calculate mouse click position offset from element's top-left corner
            const rect = draggableElement.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            // Add dragging styles
            draggableElement.style.opacity = '0.8';
            draggableElement.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';

            dragResult.textContent = 'Started dragging...';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            // Calculate new position, ensure element stays within container boundaries
            const containerRect = dragContainer.getBoundingClientRect();
            let newLeft = e.clientX - containerRect.left - offsetX;
            let newTop = e.clientY - containerRect.top - offsetY;

            // Boundary check
            const elementWidth = draggableElement.offsetWidth;
            const elementHeight = draggableElement.offsetHeight;
            const containerWidth = dragContainer.offsetWidth;
            const containerHeight = dragContainer.offsetHeight;

            newLeft = Math.max(0, Math.min(newLeft, containerWidth - elementWidth));
            newTop = Math.max(0, Math.min(newTop, containerHeight - elementHeight));

            // Check if element should snap to an area
            isSnapped = false;
            currentSnapArea = null;

            // Calculate draggable element's center point
            const elementCenterX = newLeft + elementWidth / 2;
            const elementCenterY = newTop + elementHeight / 2;

            // Check each snap area
            snapAreas.forEach(area => {
                const areaRect = area.getBoundingClientRect();
                const containerRect = dragContainer.getBoundingClientRect();

                // Calculate snap area position relative to container
                const areaLeft = areaRect.left - containerRect.left;
                const areaTop = areaRect.top - containerRect.top;
                const areaCenterX = areaLeft + areaRect.width / 2;
                const areaCenterY = areaTop + areaRect.height / 2;

                // Calculate distance between element center and snap area center
                const distanceX = Math.abs(elementCenterX - areaCenterX);
                const distanceY = Math.abs(elementCenterY - areaCenterY);

                // Snap if distance is less than threshold
                if (distanceX < snapThreshold && distanceY < snapThreshold) {
                    // Calculate snapped position (align element center with snap area center)
                    newLeft = areaCenterX - elementWidth / 2;
                    newTop = areaCenterY - elementHeight / 2;
                    isSnapped = true;
                    currentSnapArea = area.id;
                }
            });

            // Set new position
            draggableElement.style.left = newLeft + 'px';
            draggableElement.style.top = newTop + 'px';
            draggableElement.style.transform = 'none'; // Remove initial centering transform

            // Update result display
            if (isSnapped) {
                dragResult.textContent = `Snapped to ${currentSnapArea}, Position: X=${Math.round(newLeft)}px, Y=${Math.round(newTop)}px`;
                draggableElement.style.boxShadow = '0 0 10px 5px rgba(52, 152, 219, 0.5)'; // Special effect when snapped
            } else {
                dragResult.textContent = `Current position: X=${Math.round(newLeft)}px, Y=${Math.round(newTop)}px`;
                draggableElement.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
            }
        });

        document.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;

                // Restore normal style, but keep snap effect
                draggableElement.style.opacity = '1';
                if (!isSnapped) {
                    draggableElement.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                }

                if (isSnapped) {
                    dragResult.textContent = `Drag ended, snapped to ${currentSnapArea}`;
                } else {
                    dragResult.textContent += ' (Drag ended)';
                }
            }
        });

        // Hover test functionality
        const deleteButton = document.getElementById('deleteButton');
        const hoverResult = document.getElementById('hoverResult');

        deleteButton.addEventListener('mouseenter', () => {
            hoverResult.textContent = 'Mouse hovering over button - Button turns red';
        });

        deleteButton.addEventListener('mouseleave', () => {
            hoverResult.textContent = 'Mouse left button - Button returns to normal';
        });

        // Text selection test functionality
        const selectableText = document.getElementById('selectableText');
        const selectionResult = document.getElementById('selectionResult');

        document.addEventListener('selectionchange', () => {
            const selection = window.getSelection();
            const selectedText = selection.toString();

            if (selectedText && selectableText.contains(selection.anchorNode)) {
                selectionResult.textContent = `Selected text: "${selectedText}"`;
            }
        });

        // Helper function: generate random color
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

    </script>
</body>

</html>